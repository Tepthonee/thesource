import asyncio
from telethon import events
from Tepthon import zedub
from telethon.errors.rpcerrorlist import MediaEmptyError
from ..core.managers import edit_or_reply
from ..helpers.utils import _format

# ูุชุบูุฑ ููุชุญูู ูู ุญุงูุฉ ุญูุธ ุงูุจุตูุฉ ุงูุฐุงุชูุฉ
vocself = True

# ุฏุงูุฉ ูุชูุนูู ุญูุธ ุงูุตูุชูุงุช ุงูุฐุงุชูุฉ
@zedub.zed_cmd(pattern="(ุชูุนูู ุงูุจุตูู ุงูุฐุงุชูู|ุชูุนูู ุงูุจุตูู ุงูุฐุงุชูุฉ|ุชูุนูู ุงูุจุตูุฉ ุงูุฐุงุชูู|ุชูุนูู ุงูุจุตูุฉ ุงูุฐุงุชูุฉ)")
async def start_datea(event):
    global vocself

    if vocself:
        return await edit_or_reply(event, "โโุญูุธ ุงูุจุตูุฉ ุงูุฐุงุชูุฉ ุงูุชููุงุฆู ๐\nโโููุนููู .. ูุณุจูููุง โ")
    vocself = True
    await edit_or_reply(event, "โโุชู ุชูุนูู ุญูุธ ุงูุจุตูุฉ ุงูุฐุงุชูุฉ ๐\nโโุชููุงุฆููููุง .. ุจูุฌุงุญ โ")

# ุฏุงูุฉ ูุฅููุงู ุญูุธ ุงูุตูุชูุงุช ุงูุฐุงุชูุฉ
@zedub.zed_cmd(pattern="(ุงููุงู ุงูุจุตูู ุงูุฐุงุชูู|ุงููุงู ุงูุจุตูู ุงูุฐุงุชูุฉ|ุงููุงู ุงูุจุตูุฉ ุงูุฐุงุชูู|ุงููุงู ุงูุจุตูุฉ ุงูุฐุงุชูุฉ)")
async def stop_datea(event):
    global vocself
    
    if vocself:
        vocself = False
        return await edit_or_reply(event, "โโุชู ุชุนุทูู ุญูุธ ุงูุจุตูุฉ ุงูุฐุงุชูุฉ ๐\nโโุงูุงู ุตุงุฑุช ูู ุดุบุงูุฉ .. โ")
    await edit_or_reply(event, "โโุญูุธ ุงูุจุตูุฉ ุงูุฐุงุชูุฉ ุงูุชููุงุฆู ๐\nโโูุนุทููู .. ูุณุจููุงู โ")

# ุฏุงูุฉ ููุงุณุชูุงุน ููุฑุณุงุฆู ุงูุตูุชูุฉ ุงูุฐุงุชูุฉ ุงูุฌุฏูุฏุฉ ูุญูุธูุง
@zedub.on(events.NewMessage(func=lambda e: e.is_private and (e.audio or e.voice) and e.media_unread))
async def sddm(event):
    global vocself

    if vocself:
        sender = await event.get_sender()
        username = f"@{sender.username}" if sender.username else "ูุง ููุฌุฏ"
        try:
            voc = await event.download_media()  # ุชุญููู ุงููุณุงุฆุท (ุงูุตูุชูุงุช)
            await zedub.send_file("me", voc, caption=f"[แฏ ๐๐๐๐๐๐๐ โ - ุญููุธ ุงูุจุตููุฉ ุงูุฐุงุชูุฉ ๐\nโโโโโโโโโโโโโโโ\nโ ูเขชุญุจููุง .. ุนูุฒููุฒู ๐ซ\nโ ุชูู ุญูุธ ุงูุจุตูุฉ ุงูุฐุงุชูุฉ .. ุชููุงุฆููููุง โ๏ธ โ\nโ ูุนููููุงุช ุงูููุฑุณูู :-\nโข ุงูุงุณู : {_format.mentionuser(sender.first_name , sender.id)}\nโข ุงูููุฒุฑ : {username}\nโข ุงูุงูุฏู : {sender.id}")
        except MediaEmptyError:
            await edit_or_reply(event, "โโุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุตูุชูุฉ. ูุฑุฌู ุงููุญุงููุฉ ูุฌุฏุฏูุง.")

# ---------- ุชูุจูู -----------
# ุชุฃูุฏ ูู ูุฌูุฏ ูุชุทูุจุงุช ุชุดุบูู ุงูุจุฑูุงูุฌ ูุงูุฅุนุฏุงุฏุงุช ุงูุตุญูุญุฉ ูู Telethon
# ููููู ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูุฎุตุงุฆุต ุญุณุจ ุงูุญุงุฌุฉุ ูุซู ุชุนููู ูุณุงุฑ ุงูุชุฎุฒูู ุฃู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

# ูุซุงู ุนูู ุงุณุชุฎุฏุงู ุงูุฏูุงู
if __name__ == "__main__":
    # ููุง ูููู ุฅุถุงูุฉ ููุฏ ูุจุฏุก ุงูุจูุช ุฃู ุชุดุบูู ุงูุฏูุงู
    pass
